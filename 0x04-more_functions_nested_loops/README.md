This is more functions together with more nested loops
